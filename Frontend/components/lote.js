



var satelital = L.tileLayer( 'https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', { id: 'mapbox.streets' });
var rios = L.tileLayer( 'http://{s}.tile.osm.org/{z}/{x}/{y}.png', { id: 'mapbox.streets' });

var baseMaps = { "Satelital": satelital, "Rios": rios };
var centro = ["7.64960760267649", "-76.7345498858273"]; 

var map = L.map( 'map', {center: centro, zoom: 14, layers:[satelital], zoomControl: false} );
L.control.layers(null, baseMaps, {position: 'topleft'}).addTo(map);
L.control.zoom({ position: 'topleft' }).addTo(map); 

var className = ""; 
var datosJson = [
  {
      "geometry": {
          "type": "MultiPolygon",
          "id": 14,
          "codigo": "18L",
          "coordinates": [
              [
                  [
                      [
                          -76.7345498858273,
                          7.64960760267649
                      ],
                      [
                          -76.7344066371084,
                          7.64957708595418
                      ],
                      [
                          -76.7343267387708,
                          7.64961183241175
                      ],
                      [
                          -76.7342354667587,
                          7.64965806697222
                      ],
                      [
                          -76.7341699091655,
                          7.6496984340476
                      ],
                      [
                          -76.7341184979492,
                          7.64971302338837
                      ],
                      [
                          -76.7338759725299,
                          7.6498222754444
                      ],
                      [
                          -76.7338919824166,
                          7.64986642164855
                      ],
                      [
                          -76.7338289211399,
                          7.6499143227153
                      ],
                      [
                          -76.7337532460839,
                          7.64987155825479
                      ],
                      [
                          -76.7335451021045,
                          7.64998844823482
                      ],
                      [
                          -76.7333018643995,
                          7.65011521920721
                      ],
                      [
                          -76.7331544748034,
                          7.64997658221358
                      ],
                      [
                          -76.7330718741205,
                          7.65003703571998
                      ],
                      [
                          -76.7329113173114,
                          7.64998378905951
                      ],
                      [
                          -76.7327661611356,
                          7.65010742703811
                      ],
                      [
                          -76.7327032877309,
                          7.65011923233272
                      ],
                      [
                          -76.732539587196,
                          7.65002033273643
                      ],
                      [
                          -76.7325488593099,
                          7.65013160150779
                      ],
                      [
                          -76.7323520972659,
                          7.65023843017511
                      ],
                      [
                          -76.732072663519,
                          7.65039429456436
                      ],
                      [
                          -76.7319478437806,
                          7.65033654571214
                      ],
                      [
                          -76.7319456713897,
                          7.65044788501703
                      ],
                      [
                          -76.7317936728836,
                          7.65044819482266
                      ],
                      [
                          -76.7318162156563,
                          7.65033450170352
                      ],
                      [
                          -76.7317444233593,
                          7.65029212607733
                      ],
                      [
                          -76.7314792064404,
                          7.65043363006901
                      ],
                      [
                          -76.7314825089449,
                          7.65050497253674
                      ],
                      [
                          -76.731195392706,
                          7.65034403291494
                      ],
                      [
                          -76.7311947395115,
                          7.65023841996719
                      ],
                      [
                          -76.7306217617713,
                          7.64988798701543
                      ],
                      [
                          -76.7306325531426,
                          7.64978230358547
                      ],
                      [
                          -76.7303397330604,
                          7.64962425273353
                      ],
                      [
                          -76.7297702158812,
                          7.64923009435099
                      ],
                      [
                          -76.7299587562439,
                          7.6491757801384
                      ],
                      [
                          -76.7386471801429,
                          7.6493902634723
                      ],
                      [
                          -76.7386646056157,
                          7.64939480545715
                      ],
                      [
                          -76.738764913881,
                          7.64944208129687
                      ],
                      [
                          -76.7390542582579,
                          7.64965183136781
                      ],
                      [
                          -76.739050847717,
                          7.64979045211083
                      ],
                      [
                          -76.738949146681,
                          7.64982688583836
                      ],
                      [
                          -76.7386138760254,
                          7.64970148660534
                      ],
                      [
                          -76.7385983721405,
                          7.64982240995162
                      ],
                      [
                          -76.7385903199685,
                          7.64990809453858
                      ],
                      [
                          -76.738522220539,
                          7.64999985877509
                      ],
                      [
                          -76.7384774080173,
                          7.65015570543665
                      ],
                      [
                          -76.7384596623661,
                          7.65040843790261
                      ],
                      [
                          -76.7384488244264,
                          7.65046051580221
                      ],
                      [
                          -76.7383880528885,
                          7.6505109281816
                      ],
                      [
                          -76.7382427372839,
                          7.6505634766088
                      ],
                      [
                          -76.7381648006842,
                          7.6504966426002
                      ],
                      [
                          -76.7380093005409,
                          7.650423126107
                      ],
                      [
                          -76.7378472284225,
                          7.65050142098805
                      ],
                      [
                          -76.7378032001864,
                          7.65055307366691
                      ],
                      [
                          -76.7377952275307,
                          7.65065160304442
                      ],
                      [
                          -76.7378002448093,
                          7.65076860648992
                      ],
                      [
                          -76.7377692428361,
                          7.65083565931612
                      ],
                      [
                          -76.7375494317839,
                          7.65098274586268
                      ],
                      [
                          -76.7374147660429,
                          7.65102797621245
                      ],
                      [
                          -76.7373348078674,
                          7.65091991267206
                      ],
                      [
                          -76.7372523632397,
                          7.65099890139173
                      ],
                      [
                          -76.7371633329414,
                          7.65099515403593
                      ],
                      [
                          -76.7370890285186,
                          7.65096567395947
                      ],
                      [
                          -76.7369158158425,
                          7.65089928912055
                      ],
                      [
                          -76.7368681496094,
                          7.65087426550437
                      ],
                      [
                          -76.7368457050475,
                          7.65093695983253
                      ],
                      [
                          -76.736690180745,
                          7.65101237946388
                      ],
                      [
                          -76.736426005131,
                          7.65085986609402
                      ],
                      [
                          -76.7363410734406,
                          7.65089036224676
                      ],
                      [
                          -76.7362319716937,
                          7.65082966342865
                      ],
                      [
                          -76.7361350130072,
                          7.65088164248752
                      ],
                      [
                          -76.7360933679994,
                          7.6508562088302
                      ],
                      [
                          -76.7358734687424,
                          7.65069200392623
                      ],
                      [
                          -76.7356633058631,
                          7.65059838775277
                      ],
                      [
                          -76.7356106144309,
                          7.65063724845855
                      ],
                      [
                          -76.7355919731333,
                          7.65063022715125
                      ],
                      [
                          -76.7352358982947,
                          7.65042261667992
                      ],
                      [
                          -76.7352423172586,
                          7.65030411520597
                      ],
                      [
                          -76.7351448634257,
                          7.65027617098896
                      ],
                      [
                          -76.7351593183795,
                          7.65018473775223
                      ],
                      [
                          -76.7349394993011,
                          7.65003337690434
                      ],
                      [
                          -76.7349229943269,
                          7.64990930770833
                      ],
                      [
                          -76.734827063937,
                          7.64989634013963
                      ],
                      [
                          -76.734833456543,
                          7.64977355703971
                      ],
                      [
                          -76.7346216560086,
                          7.64964640978505
                      ],
                      [
                          -76.7345498858273,
                          7.64960760267649
                      ]
                  ]
              ]
          ]
      },
      "type": "Feature",
      "properties": {
          "id": 14,
          "nombre": "LOTE 1",
          "fechaSiembra": "2010-09-15",
          "centro": [
              -76.73441223706955,
              7.650101878175425
          ],
          "codigo": "18L",
          "seleccionado": false,
          "areaNeta": "9.67",
          "palmas": 1006.0,
          "idFinca": 13,
          "nombreFinca": "FINCA LA PLANA",
          "idEtapa": 3,
          "nombreEtapa": "ETAPA 02",
          "areaBruta": "11.24",
          "cantidadPalmaRegistrada": 0.0,
          "medidaBruta": "ha",
          "medidaNeta": "ha",
          "cantidadPalma": 1006.0,
          "totalHecho": 0.0,
          "promedioTotalHecho": 0.0,
          "color": ""
      }
  },
  {
      "geometry": {
          "type": "MultiPolygon",
          "id": 15,
          "codigo": "19L",
          "coordinates": [
              [
                  [
                      [
                          -76.729991942025,
                          7.64738809259593
                      ],
                      [
                          -76.7302591798999,
                          7.64706425111377
                      ],
                      [
                          -76.7303478821889,
                          7.64704199953408
                      ],
                      [
                          -76.7306661062977,
                          7.64704727721691
                      ],
                      [
                          -76.7311773743308,
                          7.64704503595008
                      ],
                      [
                          -76.7322664137246,
                          7.64709350259176
                      ],
                      [
                          -76.7334640971643,
                          7.64711959140636
                      ],
                      [
                          -76.7341542172214,
                          7.64716056122315
                      ],
                      [
                          -76.7346329286381,
                          7.64717117812257
                      ],
                      [
                          -76.7350852340742,
                          7.64716296457512
                      ],
                      [
                          -76.7357934160607,
                          7.64719296744978
                      ],
                      [
                          -76.7364507558765,
                          7.64721062086206
                      ],
                      [
                          -76.7367962349554,
                          7.64722567440018
                      ],
                      [
                          -76.737757265021,
                          7.64724416619848
                      ],
                      [
                          -76.7379695123668,
                          7.64726365825661
                      ],
                      [
                          -76.738130889811,
                          7.64726628028566
                      ],
                      [
                          -76.7381854024691,
                          7.64728584095508
                      ],
                      [
                          -76.7382213397993,
                          7.64734686946688
                      ],
                      [
                          -76.7382343379947,
                          7.64755683739236
                      ],
                      [
                          -76.7383094829249,
                          7.64760305109275
                      ],
                      [
                          -76.7383153188195,
                          7.64778972451272
                      ],
                      [
                          -76.7383857853267,
                          7.64783596705081
                      ],
                      [
                          -76.7383847193251,
                          7.64804135398786
                      ],
                      [
                          -76.7384642100511,
                          7.64803386185504
                      ],
                      [
                          -76.7384788531999,
                          7.64813179392831
                      ],
                      [
                          -76.7385328148777,
                          7.64815713346331
                      ],
                      [
                          -76.7385344572319,
                          7.64842201727921
                      ],
                      [
                          -76.7386142084885,
                          7.6484565330985
                      ],
                      [
                          -76.7385968548287,
                          7.64867602372313
                      ],
                      [
                          -76.7386860644122,
                          7.64872681820543
                      ],
                      [
                          -76.7386889970007,
                          7.64882248865589
                      ],
                      [
                          -76.738745214317,
                          7.64889946898751
                      ],
                      [
                          -76.7387790605121,
                          7.64901097598158
                      ],
                      [
                          -76.7387736999412,
                          7.64927823682973
                      ],
                      [
                          -76.738772751842,
                          7.64939310599752
                      ],
                      [
                          -76.7365201031388,
                          7.64933193920051
                      ],
                      [
                          -76.735867337367,
                          7.64932149407423
                      ],
                      [
                          -76.7340503186294,
                          7.64926780240324
                      ],
                      [
                          -76.7317409632902,
                          7.64919995029768
                      ],
                      [
                          -76.7299438476273,
                          7.64914046578996
                      ],
                      [
                          -76.7297653008809,
                          7.64914699067513
                      ],
                      [
                          -76.7296116588668,
                          7.64908846929802
                      ],
                      [
                          -76.7291762029954,
                          7.64873096554391
                      ],
                      [
                          -76.7290920563654,
                          7.64861029138617
                      ],
                      [
                          -76.7291045322141,
                          7.64857539467501
                      ],
                      [
                          -76.7292335523702,
                          7.64847601996622
                      ],
                      [
                          -76.7293574017056,
                          7.64842008896499
                      ],
                      [
                          -76.7294758467358,
                          7.64822310243254
                      ],
                      [
                          -76.729991942025,
                          7.64738809259593
                      ]
                  ]
              ]
          ]
      },
      "type": "Feature",
      "properties": {
          "id": 15,
          "nombre": "LOTE 2",
          "fechaSiembra": "2010-10-02",
          "centro": [
              -76.73393555843876,
              7.6482175527658
          ],
          "codigo": "19L",
          "seleccionado": false,
          "areaNeta": "22.34",
          "palmas": 2323.0,
          "idFinca": 13,
          "nombreFinca": "FINCA LA PLANA",
          "idEtapa": 3,
          "nombreEtapa": "ETAPA 02",
          "areaBruta": "25.8",
          "cantidadPalmaRegistrada": 0.0,
          "medidaBruta": "ha",
          "medidaNeta": "ha",
          "cantidadPalma": 2323.0,
          "totalHecho": 0.0,
          "promedioTotalHecho": 0.0,
          "color": ""
      }
  },
  {
      "geometry": {
          "type": "MultiPolygon",
          "id": 16,
          "codigo": "20L",
          "coordinates": [
              [
                  [
                      [
                          -76.7377823556524,
                          7.64566479118813
                      ],
                      [
                          -76.7377832053376,
                          7.64580191608009
                      ],
                      [
                          -76.7378045055777,
                          7.64593797511528
                      ],
                      [
                          -76.7377554872298,
                          7.64602783377218
                      ],
                      [
                          -76.7378275742243,
                          7.64614140091619
                      ],
                      [
                          -76.7378902651706,
                          7.64621468540671
                      ],
                      [
                          -76.7379670515129,
                          7.64650808479245
                      ],
                      [
                          -76.7381657414237,
                          7.64722870918675
                      ],
                      [
                          -76.7360048178404,
                          7.64716918547979
                      ],
                      [
                          -76.7303384333688,
                          7.64703695097766
                      ],
                      [
                          -76.730815199301,
                          7.64608365750905
                      ],
                      [
                          -76.7312708163953,
                          7.64538657581276
                      ],
                      [
                          -76.7317124944677,
                          7.64487939993109
                      ],
                      [
                          -76.7342856426593,
                          7.64491926936782
                      ],
                      [
                          -76.7364338578279,
                          7.6450088812128
                      ],
                      [
                          -76.7364860100313,
                          7.64510712213438
                      ],
                      [
                          -76.73648685924,
                          7.64524424717492
                      ],
                      [
                          -76.7366679192766,
                          7.6453502640567
                      ],
                      [
                          -76.7369094566391,
                          7.64551161712663
                      ],
                      [
                          -76.7372189999234,
                          7.64555684706148
                      ],
                      [
                          -76.7373191520766,
                          7.64556288947487
                      ],
                      [
                          -76.7375640108596,
                          7.64561766920261
                      ],
                      [
                          -76.7376790329514,
                          7.64562686057047
                      ],
                      [
                          -76.7377823556524,
                          7.64566479118813
                      ]
                  ]
              ]
          ]
      },
      "type": "Feature",
      "properties": {
          "id": 16,
          "nombre": "LOTE 3",
          "fechaSiembra": "2011-02-08",
          "centro": [
              -76.73425208739624,
              7.64605405455892
          ],
          "codigo": "20L",
          "seleccionado": false,
          "areaNeta": "15.9",
          "palmas": 1828.0,
          "idFinca": 13,
          "nombreFinca": "FINCA LA PLANA",
          "idEtapa": 4,
          "nombreEtapa": "ETAPA 03",
          "areaBruta": "18.46",
          "cantidadPalmaRegistrada": 0.0,
          "medidaBruta": "ha",
          "medidaNeta": "ha",
          "cantidadPalma": 1828.0,
          "totalHecho": 0.0,
          "promedioTotalHecho": 0.0,
          "color": ""
      }
  }
]; 

var circulo = [];


//coordenadas
//  7.64960760267649
//  -76.7345498858273,

//  7.64988798701543
// -76.7306217617713

//coordenadas 2 
//  7.64709350259176
// -76.7322664137246

// 7.64726365825661
//-76.7379695123668


//Coordenadas 3
// 7.64614140091619
// -76.7378275742243

// 7.64551161712663
// -76.7369094566391


var geoLayer = L.geoJson(datosJson, {
    style: function(feature) {
        return { className:className, color: "#4bb34b" }; 
    },
    // onEachFeature: function(feature, layer) {
    //     var popupText2 = "<b>Codigo:</b> " + feature.properties.codigo + "<br><b> Lote:</b>" + feature.properties.nombre; 

    //     var popupText = `<b>Codigo:</b> ${feature.properties.codigo} <br><b> Lote:</b> ${feature.properties.nombre}`
        
    //     console.log(popupText);
        
    //     var popupInfo = "" + feature.properties.codigo ;
    //     layer.bindPopup(popupText, { closeButton: true, offset: L.point(0, 0) });
    //     layer.on('click', function() { layer.openPopup(); });
    //     layer.bindTooltip( popupInfo, {permanent: true, direction:"center", className:"nombreLote"});
    // },
    // pointToLayer: function(feature, latlng) {
    //     return L.circleMarker(latlng, {
    //         radius: Math.round(feature.properties.mag) * 5,
    //     }).bindTooltip(label, {permanent: true, opacity: 0.7}).openTooltip();
    // },
}).addTo(map);










  //   // Datos GeoJSON
    const geojsonData = [
      {
          "geometry": {
              "type": "MultiPolygon",
              "id": 14,
              "codigo": "18L",
              "coordinates": [
                  [
                      [
                          [
                              -76.7345498858273,
                              7.64960760267649
                          ],
                          [
                              -76.7344066371084,
                              7.64957708595418
                          ],
                          [
                              -76.7343267387708,
                              7.64961183241175
                          ],
                          [
                              -76.7342354667587,
                              7.64965806697222
                          ],
                          [
                              -76.7341699091655,
                              7.6496984340476
                          ],
                          [
                              -76.7341184979492,
                              7.64971302338837
                          ],
                          [
                              -76.7338759725299,
                              7.6498222754444
                          ],
                          [
                              -76.7338919824166,
                              7.64986642164855
                          ],
                          [
                              -76.7338289211399,
                              7.6499143227153
                          ],
                          [
                              -76.7337532460839,
                              7.64987155825479
                          ],
                          [
                              -76.7335451021045,
                              7.64998844823482
                          ],
                          [
                              -76.7333018643995,
                              7.65011521920721
                          ],
                          [
                              -76.7331544748034,
                              7.64997658221358
                          ],
                          [
                              -76.7330718741205,
                              7.65003703571998
                          ],
                          [
                              -76.7329113173114,
                              7.64998378905951
                          ],
                          [
                              -76.7327661611356,
                              7.65010742703811
                          ],
                          [
                              -76.7327032877309,
                              7.65011923233272
                          ],
                          [
                              -76.732539587196,
                              7.65002033273643
                          ],
                          [
                              -76.7325488593099,
                              7.65013160150779
                          ],
                          [
                              -76.7323520972659,
                              7.65023843017511
                          ],
                          [
                              -76.732072663519,
                              7.65039429456436
                          ],
                          [
                              -76.7319478437806,
                              7.65033654571214
                          ],
                          [
                              -76.7319456713897,
                              7.65044788501703
                          ],
                          [
                              -76.7317936728836,
                              7.65044819482266
                          ],
                          [
                              -76.7318162156563,
                              7.65033450170352
                          ],
                          [
                              -76.7317444233593,
                              7.65029212607733
                          ],
                          [
                              -76.7314792064404,
                              7.65043363006901
                          ],
                          [
                              -76.7314825089449,
                              7.65050497253674
                          ],
                          [
                              -76.731195392706,
                              7.65034403291494
                          ],
                          [
                              -76.7311947395115,
                              7.65023841996719
                          ],
                          [
                              -76.7306217617713,
                              7.64988798701543
                          ],
                          [
                              -76.7306325531426,
                              7.64978230358547
                          ],
                          [
                              -76.7303397330604,
                              7.64962425273353
                          ],
                          [
                              -76.7297702158812,
                              7.64923009435099
                          ],
                          [
                              -76.7299587562439,
                              7.6491757801384
                          ],
                          [
                              -76.7386471801429,
                              7.6493902634723
                          ],
                          [
                              -76.7386646056157,
                              7.64939480545715
                          ],
                          [
                              -76.738764913881,
                              7.64944208129687
                          ],
                          [
                              -76.7390542582579,
                              7.64965183136781
                          ],
                          [
                              -76.739050847717,
                              7.64979045211083
                          ],
                          [
                              -76.738949146681,
                              7.64982688583836
                          ],
                          [
                              -76.7386138760254,
                              7.64970148660534
                          ],
                          [
                              -76.7385983721405,
                              7.64982240995162
                          ],
                          [
                              -76.7385903199685,
                              7.64990809453858
                          ],
                          [
                              -76.738522220539,
                              7.64999985877509
                          ],
                          [
                              -76.7384774080173,
                              7.65015570543665
                          ],
                          [
                              -76.7384596623661,
                              7.65040843790261
                          ],
                          [
                              -76.7384488244264,
                              7.65046051580221
                          ],
                          [
                              -76.7383880528885,
                              7.6505109281816
                          ],
                          [
                              -76.7382427372839,
                              7.6505634766088
                          ],
                          [
                              -76.7381648006842,
                              7.6504966426002
                          ],
                          [
                              -76.7380093005409,
                              7.650423126107
                          ],
                          [
                              -76.7378472284225,
                              7.65050142098805
                          ],
                          [
                              -76.7378032001864,
                              7.65055307366691
                          ],
                          [
                              -76.7377952275307,
                              7.65065160304442
                          ],
                          [
                              -76.7378002448093,
                              7.65076860648992
                          ],
                          [
                              -76.7377692428361,
                              7.65083565931612
                          ],
                          [
                              -76.7375494317839,
                              7.65098274586268
                          ],
                          [
                              -76.7374147660429,
                              7.65102797621245
                          ],
                          [
                              -76.7373348078674,
                              7.65091991267206
                          ],
                          [
                              -76.7372523632397,
                              7.65099890139173
                          ],
                          [
                              -76.7371633329414,
                              7.65099515403593
                          ],
                          [
                              -76.7370890285186,
                              7.65096567395947
                          ],
                          [
                              -76.7369158158425,
                              7.65089928912055
                          ],
                          [
                              -76.7368681496094,
                              7.65087426550437
                          ],
                          [
                              -76.7368457050475,
                              7.65093695983253
                          ],
                          [
                              -76.736690180745,
                              7.65101237946388
                          ],
                          [
                              -76.736426005131,
                              7.65085986609402
                          ],
                          [
                              -76.7363410734406,
                              7.65089036224676
                          ],
                          [
                              -76.7362319716937,
                              7.65082966342865
                          ],
                          [
                              -76.7361350130072,
                              7.65088164248752
                          ],
                          [
                              -76.7360933679994,
                              7.6508562088302
                          ],
                          [
                              -76.7358734687424,
                              7.65069200392623
                          ],
                          [
                              -76.7356633058631,
                              7.65059838775277
                          ],
                          [
                              -76.7356106144309,
                              7.65063724845855
                          ],
                          [
                              -76.7355919731333,
                              7.65063022715125
                          ],
                          [
                              -76.7352358982947,
                              7.65042261667992
                          ],
                          [
                              -76.7352423172586,
                              7.65030411520597
                          ],
                          [
                              -76.7351448634257,
                              7.65027617098896
                          ],
                          [
                              -76.7351593183795,
                              7.65018473775223
                          ],
                          [
                              -76.7349394993011,
                              7.65003337690434
                          ],
                          [
                              -76.7349229943269,
                              7.64990930770833
                          ],
                          [
                              -76.734827063937,
                              7.64989634013963
                          ],
                          [
                              -76.734833456543,
                              7.64977355703971
                          ],
                          [
                              -76.7346216560086,
                              7.64964640978505
                          ],
                          [
                              -76.7345498858273,
                              7.64960760267649
                          ]
                      ]
                  ]
              ]
          },
          "type": "Feature",
          "properties": {
              "id": 14,
              "nombre": "LOTE 1",
              "fechaSiembra": "2010-09-15",
              "centro": [
                  -76.73441223706955,
                  7.650101878175425
              ],
              "codigo": "18L",
              "seleccionado": false,
              "areaNeta": "9.67",
              "palmas": 1006.0,
              "idFinca": 13,
              "nombreFinca": "FINCA LA PLANA",
              "idEtapa": 3,
              "nombreEtapa": "ETAPA 02",
              "areaBruta": "11.24",
              "cantidadPalmaRegistrada": 0.0,
              "medidaBruta": "ha",
              "medidaNeta": "ha",
              "cantidadPalma": 1006.0,
              "totalHecho": 0.0,
              "promedioTotalHecho": 0.0,
              "color": ""
          }
      },
      {
          "geometry": {
              "type": "MultiPolygon",
              "id": 15,
              "codigo": "19L",
              "coordinates": [
                  [
                      [
                          [
                              -76.729991942025,
                              7.64738809259593
                          ],
                          [
                              -76.7302591798999,
                              7.64706425111377
                          ],
                          [
                              -76.7303478821889,
                              7.64704199953408
                          ],
                          [
                              -76.7306661062977,
                              7.64704727721691
                          ],
                          [
                              -76.7311773743308,
                              7.64704503595008
                          ],
                          [
                              -76.7322664137246,
                              7.64709350259176
                          ],
                          [
                              -76.7334640971643,
                              7.64711959140636
                          ],
                          [
                              -76.7341542172214,
                              7.64716056122315
                          ],
                          [
                              -76.7346329286381,
                              7.64717117812257
                          ],
                          [
                              -76.7350852340742,
                              7.64716296457512
                          ],
                          [
                              -76.7357934160607,
                              7.64719296744978
                          ],
                          [
                              -76.7364507558765,
                              7.64721062086206
                          ],
                          [
                              -76.7367962349554,
                              7.64722567440018
                          ],
                          [
                              -76.737757265021,
                              7.64724416619848
                          ],
                          [
                              -76.7379695123668,
                              7.64726365825661
                          ],
                          [
                              -76.738130889811,
                              7.64726628028566
                          ],
                          [
                              -76.7381854024691,
                              7.64728584095508
                          ],
                          [
                              -76.7382213397993,
                              7.64734686946688
                          ],
                          [
                              -76.7382343379947,
                              7.64755683739236
                          ],
                          [
                              -76.7383094829249,
                              7.64760305109275
                          ],
                          [
                              -76.7383153188195,
                              7.64778972451272
                          ],
                          [
                              -76.7383857853267,
                              7.64783596705081
                          ],
                          [
                              -76.7383847193251,
                              7.64804135398786
                          ],
                          [
                              -76.7384642100511,
                              7.64803386185504
                          ],
                          [
                              -76.7384788531999,
                              7.64813179392831
                          ],
                          [
                              -76.7385328148777,
                              7.64815713346331
                          ],
                          [
                              -76.7385344572319,
                              7.64842201727921
                          ],
                          [
                              -76.7386142084885,
                              7.6484565330985
                          ],
                          [
                              -76.7385968548287,
                              7.64867602372313
                          ],
                          [
                              -76.7386860644122,
                              7.64872681820543
                          ],
                          [
                              -76.7386889970007,
                              7.64882248865589
                          ],
                          [
                              -76.738745214317,
                              7.64889946898751
                          ],
                          [
                              -76.7387790605121,
                              7.64901097598158
                          ],
                          [
                              -76.7387736999412,
                              7.64927823682973
                          ],
                          [
                              -76.738772751842,
                              7.64939310599752
                          ],
                          [
                              -76.7365201031388,
                              7.64933193920051
                          ],
                          [
                              -76.735867337367,
                              7.64932149407423
                          ],
                          [
                              -76.7340503186294,
                              7.64926780240324
                          ],
                          [
                              -76.7317409632902,
                              7.64919995029768
                          ],
                          [
                              -76.7299438476273,
                              7.64914046578996
                          ],
                          [
                              -76.7297653008809,
                              7.64914699067513
                          ],
                          [
                              -76.7296116588668,
                              7.64908846929802
                          ],
                          [
                              -76.7291762029954,
                              7.64873096554391
                          ],
                          [
                              -76.7290920563654,
                              7.64861029138617
                          ],
                          [
                              -76.7291045322141,
                              7.64857539467501
                          ],
                          [
                              -76.7292335523702,
                              7.64847601996622
                          ],
                          [
                              -76.7293574017056,
                              7.64842008896499
                          ],
                          [
                              -76.7294758467358,
                              7.64822310243254
                          ],
                          [
                              -76.729991942025,
                              7.64738809259593
                          ]
                      ]
                  ]
              ]
          },
          "type": "Feature",
          "properties": {
              "id": 15,
              "nombre": "LOTE 2",
              "fechaSiembra": "2010-10-02",
              "centro": [
                  -76.73393555843876,
                  7.6482175527658
              ],
              "codigo": "19L",
              "seleccionado": false,
              "areaNeta": "22.34",
              "palmas": 2323.0,
              "idFinca": 13,
              "nombreFinca": "FINCA LA PLANA",
              "idEtapa": 3,
              "nombreEtapa": "ETAPA 02",
              "areaBruta": "25.8",
              "cantidadPalmaRegistrada": 0.0,
              "medidaBruta": "ha",
              "medidaNeta": "ha",
              "cantidadPalma": 2323.0,
              "totalHecho": 0.0,
              "promedioTotalHecho": 0.0,
              "color": ""
          }
      },
      {
          "geometry": {
              "type": "MultiPolygon",
              "id": 16,
              "codigo": "20L",
              "coordinates": [
                  [
                      [
                          [
                              -76.7377823556524,
                              7.64566479118813
                          ],
                          [
                              -76.7377832053376,
                              7.64580191608009
                          ],
                          [
                              -76.7378045055777,
                              7.64593797511528
                          ],
                          [
                              -76.7377554872298,
                              7.64602783377218
                          ],
                          [
                              -76.7378275742243,
                              7.64614140091619
                          ],
                          [
                              -76.7378902651706,
                              7.64621468540671
                          ],
                          [
                              -76.7379670515129,
                              7.64650808479245
                          ],
                          [
                              -76.7381657414237,
                              7.64722870918675
                          ],
                          [
                              -76.7360048178404,
                              7.64716918547979
                          ],
                          [
                              -76.7303384333688,
                              7.64703695097766
                          ],
                          [
                              -76.730815199301,
                              7.64608365750905
                          ],
                          [
                              -76.7312708163953,
                              7.64538657581276
                          ],
                          [
                              -76.7317124944677,
                              7.64487939993109
                          ],
                          [
                              -76.7342856426593,
                              7.64491926936782
                          ],
                          [
                              -76.7364338578279,
                              7.6450088812128
                          ],
                          [
                              -76.7364860100313,
                              7.64510712213438
                          ],
                          [
                              -76.73648685924,
                              7.64524424717492
                          ],
                          [
                              -76.7366679192766,
                              7.6453502640567
                          ],
                          [
                              -76.7369094566391,
                              7.64551161712663
                          ],
                          [
                              -76.7372189999234,
                              7.64555684706148
                          ],
                          [
                              -76.7373191520766,
                              7.64556288947487
                          ],
                          [
                              -76.7375640108596,
                              7.64561766920261
                          ],
                          [
                              -76.7376790329514,
                              7.64562686057047
                          ],
                          [
                              -76.7377823556524,
                              7.64566479118813
                          ]
                      ]
                  ]
              ]
          },
          "type": "Feature",
          "properties": {
              "id": 16,
              "nombre": "LOTE 3",
              "fechaSiembra": "2011-02-08",
              "centro": [
                  -76.73425208739624,
                  7.64605405455892
              ],
              "codigo": "20L",
              "seleccionado": false,
              "areaNeta": "15.9",
              "palmas": 1828.0,
              "idFinca": 13,
              "nombreFinca": "FINCA LA PLANA",
              "idEtapa": 4,
              "nombreEtapa": "ETAPA 03",
              "areaBruta": "18.46",
              "cantidadPalmaRegistrada": 0.0,
              "medidaBruta": "ha",
              "medidaNeta": "ha",
              "cantidadPalma": 1828.0,
              "totalHecho": 0.0,
              "promedioTotalHecho": 0.0,
              "color": ""
          }
      }
  ]







function  crearValor(coordenadas, mapaAsignado, color, datos) {



    let codigoLabor = dato.Codigo_Labor
    let labor = dato.Labor
    let grupoLabor = dato.Grupo_Labor
    let fecha = datos.fecha
    let idLote = datos.idLote
    let lote = datos.lote
    let descripcion = datos.descripcion
    let descripcionFinal = datos.descripcionFinal

    // console.log(descripcion, descripcionFinal, fecha);
    
    var circle = L.circle(coordenadas, {
        color: '#ffa70f',
        fillColor: '#ffa70f',
        fillOpacity: 0.2,
        radius: 1
    }).addTo(mapaAsignado);

    let popupText = `
    <b>Codigo Labor:</b> ${codigoLabor}
    <br>
    <b>Labor:</b> ${labor}
    <br>
    <b>Grupo Labor:</b> ${grupoLabor}
    <br>
    <b>Fecha:</b> ${fecha}
    <br>
    <b>ID Lote:</b> ${idLote} 
    <br>
    <b>Lote:</b> ${lote}
    <br>
    <b>Descripcion:</b> ${descripcion}
    <br>
    <b>Descripcion Final:</b> ${descripcionFinal}
    <br>
    `

    circle.bindPopup(popupText)
    circulo.push(circle);
}




function eliminarCirculos() {
    circulo.forEach(circle => map.removeLayer(circle));
    circulo = []
}




new Vue({
    el: '#app',
    data() {
        return {
            url: 'http://localhost:8000',
            coordenadas: null,
            datosLotes: null,
            lotes: [],
            lote: null,
            datosLotes: [],
            datosPorFecha: false,
            datosPorMes: false,
            datosElegir: null,
            mostrarBoton: false,
        }
    },
    methods: {

       filtradoLabores (valor) {


        eliminarCirculos()

        if (valor === 0) {

            let valorMes = document.getElementById('mes')
            let mes = valorMes.value
            let parsearFecha = new Date(mes)
            let obtenerMes = parsearFecha.getUTCMonth()
            let mesArreglado = obtenerMes + 1
    

            const datos = {
                mesArreglado
            }

            axios.post(this.url+'/lote/obtenerMes', datos).then(response => {

            let datos = response.data[0]
            
            if (response.data <= 0) {
                return  Swal.fire({
                    icon: "error",
                    title: "Error!",
                    text: "No hay datos a renderizar",
                    });
            }
    
                for (dato of datos) {

                    let color = dato.Color

                    let capturaFecha = dato.Fecha

                    const regex = /(\d{4}-\d{2}-\d{2}).*/
                    fecha = capturaFecha.replace(regex, '$1')

                    
                    let coordenadas = [dato.Latitud, dato.Longitud]


                    let valores = {
                        codigoLabor: dato.Codigo_Labor,
                        labor: dato.Labor,
                        grupoLabor: dato.Grupo_Labor,
                        fecha,
                        idLote: dato.ID_Lote,
                        lote: dato.Lote,
                        descripcion: dato.Descripcion,
                        descripcionFinal: dato.Descripcion_Final,
                    }

                 crearValor(coordenadas, map, color, valores)

        }}).catch(error => console.error(error))
        }

        if (valor === 1) {

            let valorInicio = document.getElementById('fechaInicio')
            let valorFinal = document.getElementById('fechaFinal')
    
            const valorFechaInicio = valorInicio.value
            const valorFechaFinal = valorFinal.value
    
            if(!valorFechaInicio && !valorFechaFinal) {
                return  Swal.fire({
                    icon: "error",
                    title: "Error!",
                    text: "Ingrese porfavor las 2 fechas",
                  });
            }

            if(!valorFechaInicio || !valorFechaFinal) {
                return  Swal.fire({
                    icon: "error",
                    title: "Error!",
                    text: "Ingrese porfavor las 2 fechas correspondientes",
                  });
            }


            const fechaInicio = new Date(valorFechaInicio)
            const fechaFinal = new Date(valorFechaFinal)

            const fechaInicioToIso = fechaInicio.toISOString()
            const fechaFinalToIso =  fechaFinal.toISOString()

            if (fechaInicioToIso > fechaFinalToIso) {
                return  Swal.fire({
                    icon: "error",
                    title: "Rango de fechas incorrecto",
                    text: "El rango de fecha inicial es mayor al rango de fecha final",
                  });
            }

            const datos = {
                fechaInicioToIso,
                fechaFinalToIso,
            }




            
            axios.post(this.url+'/lote/obtenerFechas', datos).then(response => {

                let datos = response.data[0]
    
                if (response.data <= 0) {
                    return  Swal.fire({
                        icon: "error",
                        title: "Error!",
                        text: "No hay datos a renderizar",
                        });
                }
        
                    for (dato of datos) {
    
                        let color = ''
                        switch (dato.Color) {
                            case 'Amarillo':
                                color = 'yellow'
                                break;
                            case 'Rojo':
                                color = 'red'
                                break;
                            case 'Morado':
                                color = 'purple'
                                break;
                            default:
                                color = 'blue'
                                break;
                        }
    
                        let capturaFecha = dato.Fecha
    
                        const regex = /(\d{4}-\d{2}-\d{2}).*/
                        fecha = capturaFecha.replace(regex, '$1')
    
                        
                        let coordenadas = [dato.Latitud, dato.Longitud]
    
    
                        let valores = {
                            codigoLabor: dato.Codigo_Labor,
                            labor: dato.Labor,
                            grupoLabor: dato.Grupo_Labor,
                            fecha,
                            idLote: dato.ID_Lote,
                            lote: dato.Lote,
                            descripcion: dato.Descripcion,
                            descripcionFinal: dato.Descripcion_Final,
                        }
    
                     crearValor(coordenadas, map, color, valores)
            }})
        }
       },

       obtenerLoteInicio() {

        
        const fecha = new Date()
        const fechaToIso = fecha.toISOString()

        const datos = {
            fechaToIso
        }

        axios.post(this.url+'/lote/obtenerInicio', datos).then(response => {

            let datos = response.data[0]

                console.log(datos);
                
            if (response.data <= 0) {
                return;
            }
    
                for (dato of datos) {

                    let color = ''
                    switch (dato.Color) {
                        case 'Amarillo':
                            color = 'yellow'
                            break;
                        case 'Rojo':
                            color = 'red'
                            break;
                        case 'Morado':
                            color = 'purple'
                            break;
                        default:
                            color = 'blue'
                            break;
                    }

                    let capturaFecha = dato.Fecha

                    const regex = /(\d{4}-\d{2}-\d{2}).*/
                    let fecha = capturaFecha.replace(regex, '$1')

                    
                    let coordenadas = [dato.Latitud, dato.Longitud]


                    let valores = {
                        codigoLabor: dato.Codigo_Labor,
                        labor: dato.Labor,
                        grupoLabor: dato.Grupo_Labor,
                        fecha,
                        idLote: dato.ID_Lote,
                        lote: dato.Lote,
                        descripcion: dato.Descripcion,
                        descripcionFinal: dato.Descripcion_Final,
                    }

            crearValor(coordenadas, map, color, valores)

        }})



       }

       


    },
    mounted() {
        this.obtenerLoteInicio()
    }

    
})
